<!DOCTYPE html>
<html>
<head>
    <title>API Debug</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        pre { background: #f5f5f5; padding: 10px; border: 1px solid #ddd; }
        h2 { color: #333; }
    </style>
</head>
<body>
    <h1>Dashboard API Debug</h1>
    
    <h2>1. Stats API Response:</h2>
    <pre id="stats-response">Loading...</pre>
    
    <h2>2. My Courses API Response:</h2>
    <pre id="courses-response">Loading...</pre>
    
    <h2>3. Rendered Courses Count:</h2>
    <pre id="courses-count">Loading...</pre>

    <script>
        async function testAPIs() {
            try {
                // Test stats API
                const statsResp = await fetch('dashboard_api.php?action=stats');
                const statsText = await statsResp.text();
                document.getElementById('stats-response').textContent = 
                    `Status: ${statsResp.status}\n` +
                    `Headers: ${statsResp.headers.get('content-type')}\n` +
                    `Body: ${statsText}`;
                
                // Test courses API
                const coursesResp = await fetch('dashboard_api.php?action=my_courses');
                const coursesText = await coursesResp.text();
                const coursesData = JSON.parse(coursesText);
                
                document.getElementById('courses-response').textContent = 
                    `Status: ${coursesResp.status}\n` +
                    `Success: ${coursesData.success}\n` +
                    `Count: ${coursesData.count}\n` +
                    `Courses: ${JSON.stringify(coursesData.courses, null, 2)}`;
                
                // Count unique courses
                const uniqueCourses = new Set(coursesData.courses.map(c => c.id));
                document.getElementById('courses-count').textContent = 
                    `Total in response: ${coursesData.courses.length}\n` +
                    `Unique course IDs: ${uniqueCourses.size}\n` +
                    `Course IDs: ${Array.from(uniqueCourses).join(', ')}`;
                    
            } catch (error) {
                document.getElementById('stats-response').textContent = 'ERROR: ' + error.message;
            }
        }
        
        testAPIs();
    </script>
</body>
</html>
