<!DOCTYPE html>
<html>

<head>
    <title>API Test - After Fix</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f5f5f5;
        }

        .success {
            color: green;
            font-weight: bold;
        }

        .error {
            color: red;
            font-weight: bold;
        }

        pre {
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            margin: 10px 0;
        }
    </style>
</head>

<body>
    <h1>Dashboard API Test - After Column Fix</h1>

    <h2>Stats API:</h2>
    <div id="stats-status">Testing...</div>
    <pre id="stats-data"></pre>

    <h2>Courses API:</h2>
    <div id="courses-status">Testing...</div>
    <pre id="courses-data"></pre>

    <script>
        async function testAPIs() {
            // Test Stats API
            try {
                const statsResp = await fetch('dashboard_api.php?action=stats');
                const statsData = await statsResp.json();

                if (statsData.success) {
                    document.getElementById('stats-status').innerHTML = '<span class="success">✓ SUCCESS</span>';
                    document.getElementById('stats-data').textContent = JSON.stringify(statsData, null, 2);
                } else {
                    document.getElementById('stats-status').innerHTML = '<span class="error">✗ FAILED</span>';
                    document.getElementById('stats-data').textContent = JSON.stringify(statsData, null, 2);
                }
            } catch (error) {
                document.getElementById('stats-status').innerHTML = '<span class="error">✗ ERROR</span>';
                document.getElementById('stats-data').textContent = error.message;
            }

            // Test Courses API
            try {
                const coursesResp = await fetch('dashboard_api.php?action=my_courses');
                const coursesData = await coursesResp.json();

                if (coursesData.success) {
                    const uniqueIds = new Set(coursesData.courses.map(c => c.id));
                    document.getElementById('courses-status').innerHTML =
                        `<span class="success">✓ SUCCESS</span> - ${coursesData.count} courses, ${uniqueIds.size} unique IDs`;
                    document.getElementById('courses-data').textContent =
                        `Courses:\n${coursesData.courses.map(c => `- ID ${c.id}: ${c.title}`).join('\n')}`;
                } else {
                    document.getElementById('courses-status').innerHTML = '<span class="error">✗ FAILED</span>';
                    document.getElementById('courses-data').textContent = JSON.stringify(coursesData, null, 2);
                }
            } catch (error) {
                document.getElementById('courses-status').innerHTML = '<span class="error">✗ ERROR</span>';
                document.getElementById('courses-data').textContent = error.message;
            }
        }

        testAPIs();
    </script>
</body>

</html>